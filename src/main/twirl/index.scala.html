<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
    <link rel="stylesheet" type="text/css" href="matchmaking/css/site.css">

    <meta charset="utf-8">
    <title>HOTSextra matchmaker</title>
  </head>
  <body>
    <h1>Test the matchmaker through this rudimentary interface!</h1>
    <fieldset>
      <h3>setup matchmaker instance</h3>
      <p>These paramaters set the matchmaking algorithm</p>
      <p>Once you start running, the matchmaker starts, and they can't be changed anymore. To change them later, refresh the page.</p>
      <ul data-bind="with: basic">
        <li title="The 'score' is the target std of MMR averages"><input type="text" data-bind="value: target"> target score</input></li>
        <li title="time starts to reduce the target score after this time in seconds"><input type="text" data-bind="value: startseconds"> time starts at</input></li>
        <li title="the number of points per second to subtract from the target score after the above timer expires"><input type="text" data-bind="value: secondsperpoint"> seconds per point</input></li>
      </ul>
    </fieldset>
    <fieldset>
      <h3>entry generation</h3>
      <p>These parameters define the test entries that are being created.</p>
      <p>Entries are generated with an MMR that consists of an expectency value and an uncertainty. The MMR expectency values are generated by a seeded pseudorandom gaussian. The standard deviations are generated by a gamma distribution with k = 1.3 and Î¼ is configurable.</p>
      <ul data-bind="with: generation">
        <li><input type="text" data-bind="value: seed"> the seed to use for random number generation</input></li>
        <li><input type="text" data-bind="value: avgmmr"> expectency value of MMR per player</input></li>
        <li><input type="text" data-bind="value: stdmmr"> standard deviation of expectency values</input></li>
        <li><input type="text" data-bind="value: meanstd"> mean standard deviation per player</input></li>
        <li><input type="text" data-bind="value: speed"> entries per second</input></li>
      </ul>
      <input type="button" value="run" data-bind="click: runsocket, enable: !running()"></input>
      <input type="button" value="stop" data-bind="click: stopgeneration, enable: running()"></input>
    </fieldset>
    <div data-bind="with: results">
      <div id="waiting">
      <h2><span data-bind="text: numwaiting"></span> waiting players</h2>
      <table>
        <thead>
          <tr>
            <th>MMR</th>
            <th>sigma</th>
            <th colspan="2">interval</th>
            <th>queued</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: waiting">
          <tr>
            <td data-bind="text: mmr"></td>
            <td data-bind="text: sigma"></td>
            <td data-bind="text: minMMR"></td>
            <td data-bind="text: maxMMR"></td>
            <td data-bind="text: waitingFor"></td>
          </tr>
        </tbody>
      </table>
      </div>
      <div id="found">
      <h2>Most recently found matches</h2>
      <ul data-bind="foreach: found">
        <li>
          <table>
            <tr>
              <th>MMR</th>
              <th>time waited</th>
              <th>MMR</th>
              <th>time waited</th>
            </tr>
            <tbody data-bind="foreach: pairs">
              <tr>
                <td data-bind="text: p1mmr"></td>
                <td><span data-bind="text: p1waited"></span> seconds</td>
                <td data-bind="text: p2mmr"></td>
                <td><span data-bind="text: p2waited"></span> seconds</td>
              </tr>
            </tbody>
          </table>
        </li>
      </ul>
      </div>
    </div>
  </body>
  <script src="http://simjs.com/_downloads/sim-0.26.js"></script>
  <script src="matchmaking/script/site"></script>
</html>